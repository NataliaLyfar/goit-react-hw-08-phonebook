{"version":3,"file":"static/js/39.a9f64cd7.chunk.js","mappings":"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","sources":["firebase/firebase.js","pages/ProfilePage/index.jsx"],"sourcesContent":["import { initializeApp } from \"firebase/app\";\nimport { getStorage } from 'firebase/storage';\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyBGW_j0LEud3iyjGJevWLt4TetIscAWlyY\",\n  authDomain: \"phonebook-381ff.firebaseapp.com\",\n  projectId: \"phonebook-381ff\",\n  storageBucket: \"phonebook-381ff.appspot.com\",\n  messagingSenderId: \"474948812701\",\n  appId: \"1:474948812701:web:8e56c64208b5d5883ff974\"\n};\n\nconst app = initializeApp(firebaseConfig);\nexport const storage = getStorage(app);","import { useEffect, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport  authSelectors  from \"redux/auth/authSelectors\";\nimport { Title, List, Box, TertiaryButton, SecondaryButton } from \"components/ui\";\nimport { BsFillArrowLeftCircleFill } from \"react-icons/bs\";\nimport { storage } from \"../../firebase/firebase\";\nimport { ref, uploadBytes, listAll, getDownloadURL } from 'firebase/storage';\nimport { nanoid } from 'nanoid';\nimport { toast } from \"react-toastify\";\nimport { breakpoints } from \"styleConfig/breakpoints\";\nimport styled from \"styled-components\";\nimport noAvatar from 'assets/noAvatar.jpg';\nimport addPhoto from 'assets/addPhoto.jpg';\nimport BackPic from 'assets/profileBack.jpg';\nimport authSlice from \"redux/auth/authSlice\";\nimport { useLogoutUserMutation } from \"redux/phonebookApiQuery\";\n\n\nconst ProfilePage = () => {\n  const [logoutUser, {isSuccess: isLogoutSuccess}] = useLogoutUserMutation();\n  const [imageUpload, setImageUpload] = useState(null);\n  const [imageList, setImageList] = useState([]);\n  const userName = useSelector(authSelectors.getUserName);\n  const userEmail = useSelector(authSelectors.getUserEmail);\n  const [backLocation, setBackLocation] = useState(null);\n  const dispatch = useDispatch();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const onGoBack = () => navigate(backLocation);\n\n  useEffect(() => { \n    if(!userEmail) return;  \n    const imageListRef = ref(storage, `${userEmail}/images/`); \n    listAll(imageListRef).then((response) => {\n      response.items.forEach(item => {getDownloadURL(item).then(url => {\n        setImageList(prev => [url, ...prev]);\n        });\n      });\n    });\n  },[userEmail]);\n\n  useEffect(()=> {\n    if(!imageUpload) return;\n    const imageRef = ref(storage, `${userEmail}/images/${imageUpload.name + nanoid()}`);\n    uploadBytes(imageRef, imageUpload).then((snapshot) => {\n      toast.success('Image Uploaded');\n      getDownloadURL(snapshot.ref).then((url) => {\n        setImageList(prev => [url, ...prev]);\n      });\n    });\n  }, [userEmail, imageUpload]);\n\n  useEffect(() => {\n    if(isLogoutSuccess) dispatch(authSlice.actions.signout());\n  },[dispatch, isLogoutSuccess]);\n\n  useEffect(() => {\n  if (backLocation === null) setBackLocation(location?.state?.from ?? '/');\n  }, [backLocation, location?.state?.from]);\n\n\n  return (\n    <ProfileWrapper>\n      <Box>\n        <SecondaryButton onClick={onGoBack}><BsFillArrowLeftCircleFill/></SecondaryButton>\n        <Title>Personal Info</Title>\n        <AvatarWrapper>\n          {imageList.length > 0 ? (\n            <Avatar  src={imageList[0]} alt=\"avatar\" />\n            ) : (\n            <Avatar src={noAvatar} alt='noAvatar' />\n            )\n          }   \n          <UpLoad>\n            <AvatarInput type=\"file\" onChange={e => setImageUpload(e.target.files[0])}/>\n          </UpLoad>\n        </AvatarWrapper>\n        <List>\n            <Item><Label>Name</Label><Value>{userName}</Value></Item>\n            <Item><Label>Email</Label><Value>{userEmail}</Value></Item>\n        </List>\n        <TertiaryButton type=\"button\" onClick={() => logoutUser()}>\n          Log out\n        </TertiaryButton>\n      </Box>\n    </ProfileWrapper>\n  );\n};\n\nconst ProfileWrapper = styled.div`\nheight: 100%;\nposition: relative;\ndisplay: flex;\nflex-direction: column;\nalign-items: center;\nmargin: 0 auto;\nbackground-color: white;\nbackground-image: url(${BackPic});\nbackground-position: center;\nbackground-repeat: no-repeat;\nbackground-size: contain;\n`;\nconst Avatar = styled.img`\ndisplay: flex;\nalign-items: center;\njustify-content: center;\nwidth: 150px;\nheight: 190px;\nborder-radius: ${p => p.theme.radii.normal};\nbackground-color: transparent;\n  @media (${breakpoints.tablet}) {\n    width: 190px;\n    height: 230px;\n  };\n`;\nconst AvatarInput = styled.input`\nposition: absolute;\ntop: 0;\nright: 0;\ndisplay: block;\nwidth: 50px;\nheight: 50px;\nopacity: 0;\n  &:hover{\n    cursor: pointer;\n  };\n`;\nconst UpLoad = styled.div`\nz-index: 10;\nposition: absolute;\nbottom: -10px;\nright: -10px;\ndisplay: flex;\nalign-items: center;\njustify-content: center;\nwidth: 50px;\nheight: 50px;\nborder-radius: ${p => p.theme.radii.round};\nborder: none;\nbackground-color: transparent;\nbackground-image: url(${addPhoto});\nbackground-position: center;\nbackground-repeat: no-repeat;\nbackground-size: contain;\n  &:hover ${AvatarInput}{\n    cursor: pointer;\n  };\n`;\nconst AvatarWrapper = styled.div`\nposition: relative;\nmargin: ${p => p.theme.space[3]}px 0;\n`;\nconst Item =styled.li`\ndisplay: flex;\nflex-direction: column;\n`;\nconst Label = styled.span`\npadding-left: ${p => p.theme.space[2]}px;\nfont-size: ${p => p.theme.fontSizes.s};\nfont-weight: ${p => p.theme.fontWeights.semibold};\ncolor: ${p => p.theme.colors.primary};\n`;\nconst Value = styled.span`\nmargin-bottom: ${p => p.theme.space[0]}px;\npadding-left: ${p => p.theme.space[2]}px;\nfont-size: ${p => p.theme.fontSizes.l};\nfont-weight: ${p => p.theme.fontWeights.semibold};\n`;\n\nexport default ProfilePage;"],"names":["app","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","storage","getStorage","ProfileWrapper","styled","BackPic","Avatar","p","theme","radii","normal","breakpoints","AvatarInput","UpLoad","round","addPhoto","AvatarWrapper","space","Item","Label","fontSizes","s","fontWeights","semibold","colors","primary","Value","l","useLogoutUserMutation","logoutUser","isLogoutSuccess","isSuccess","useState","imageUpload","setImageUpload","imageList","setImageList","userName","useSelector","authSelectors","userEmail","backLocation","setBackLocation","dispatch","useDispatch","location","useLocation","navigate","useNavigate","useEffect","imageListRef","ref","listAll","then","response","items","forEach","item","getDownloadURL","url","prev","imageRef","name","nanoid","uploadBytes","snapshot","toast","authSlice","state","from","onClick","length","src","alt","noAvatar","type","onChange","e","target","files"],"sourceRoot":""}